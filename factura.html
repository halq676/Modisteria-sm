<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generar Factura - Modistería</title>
    <link rel="stylesheet" href="css/factura.css">
    
</head>
<body>
    <div class="container">
        <h1>Generar Nueva Factura</h1>
        <a href="menu.html" class="link-back">Volver al Menú</a> 

        <div id="prendaFacturaFeedback" class="feedback"></div>

        <div class="form-section">
            <h2>Seleccionar Prenda para Facturar</h2>
            <div>
                <label for="prendaFacturar">Prenda:</label>
                <select id="prendaFacturar">
                    <option value="">Cargando prendas...</option>
                </select>
            </div>
            <input type="button" id="generarFacturaBtn" value="Generar Vista Previa">
        </div>

        <section id="facturaPreview">
            <div id="invoice-content">
                <div class="invoice-header">
                    <h3>Factura de Modistería</h3>
                    <p>Fecha: <span id="facturaFecha"></span> | Factura N°: <span id="facturaNumero"></span></p>
                </div>

                <div class="invoice-details">
                    <h4>Datos del Cliente</h4>
                    <table>
                        <tr>
                            <th>Nombre Completo:</th>
                            <td><span id="clienteNombreFactura"></span></td>
                        </tr>
                        <tr>
                            <th>Teléfono:</th>
                            <td><span id="clienteTelefonoFactura"></span></td>
                        </tr>
                        <tr>
                            <th>Email:</th>
                            <td><span id="clienteEmailFactura"></span></td>
                        </tr>
                        <tr>
                            <th>Dirección:</th>
                            <td><span id="clienteDireccionFactura"></span></td>
                        </tr>
                    </table>
                </div>

                <div class="item-details">
                    <h4>Detalles de la Prenda</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Tipo de Prenda</th>
                                <th>Descripción</th>
                                <th>Cantidad</th>
                                <th>Costo Unitario</th>
                                <th>Total Prenda</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span id="tipoPrendaFactura"></span></td>
                                <td><span id="descripcionPrendaFactura"></span></td>
                                <td><span id="cantidadPrendaFactura"></span></td>
                                <td><span id="costoUnitarioFactura"></span></td>
                                <td><span id="totalPrendaFactura"></span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="additional-info">
                    <p><strong>Modista Asignada:</strong> <span id="modistaAsignadaFactura"></span></p>
                    <p><strong>Estado de la Prenda:</strong> <span id="estadoPrendaFactura"></span></p>
                </div>

                <div class="total-section">
                    <p>Gran Total: <span id="granTotalFactura"></span></p>
                </div>

                <div class="invoice-footer">
                    <p>¡Gracias por su preferencia!</p>
                    <p>Modistería [Modisteria Shumacher]</p>
                </div>
            </div>

            <div class="factura-actions">
                <button id="guardarFacturaBtn" class="btn">Guardar Factura</button>
                <button id="imprimirFacturaBtn" class="btn">Imprimir Factura</button>
                <a class="btn" href="menu.html">Volver al Menú</a>
            </div>
        </section>
    </div>

    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/factura.js"></script>

    <script>
document.getElementById('imprimirFacturaBtn').addEventListener('click', () => {
    const printContents = document.getElementById('invoice-content').innerHTML;
    const originalContents = document.body.innerHTML;

    document.body.innerHTML = printContents;
    window.print();
    document.body.innerHTML = originalContents;
    location.reload(); // Recarga la página para restaurar los scripts y eventos
});
</script>

</body>
</html>